R > z<-rnorm(10000)
## size가 100인 표본을 100개 비복원추출
R > z.100<-replicate(100,sample(z,size=100,replace=F))
## 100 by 100 행렬
R > str(z.100)
 num [1:100, 1:100] 2.062 0.935 -1.156 -0.035 -1.075 ...
## 첫 여섯 행만 추출
R > head(z.100)
            [,1]       [,2]       [,3]       [,4]       [,5]        [,6]       [,7]       [,8]        [,9]      [,10]      [,11]      [,12]      [,13]       [,14]      [,15]      [,16]       [,17]
[1,]  2.06185558 -0.4474908  0.7123381 -0.5300192  0.3591541  0.40144587  1.4878118 -0.9304746 -0.08874464 -1.1374296 -0.6981379 -0.8539405  0.6483400 -1.34613294 -0.5405643  1.0194205  0.09083492
[2,]  0.93528202  0.8811539 -1.2741595 -1.3461329 -0.4575309  0.54490795  1.7382209 -0.5325802 -0.64886255  0.4539531  0.8838508 -1.2151867 -0.8892445  1.03005460  0.1688449 -0.5226766  0.08588391
[3,] -1.15608411 -0.5618259 -1.6108709  1.1855743 -0.9375095 -0.63051685  0.6541933 -0.9270325  0.13836170  1.1225179 -0.8022408  1.7308828  1.4696509  0.01566621  0.4284980  1.7951613 -0.56814413
[4,] -0.03496745  0.8041299 -0.6998450 -1.4053015 -1.3413216  0.64148934 -0.7109808 -0.6182138  0.88954843 -0.5189370  0.7012556 -1.0119496 -1.1528135  0.39701732 -0.6163926 -0.4011947 -1.06472801
[5,] -1.07471204 -1.2067637 -0.4477088  0.1021910 -0.3246769 -0.13383884  0.7107482  0.1843424 -0.26664159 -1.1377579  2.0434217 -0.9458108  1.8508177  0.66821814  0.4065361  0.5374195  0.69303860
[6,] -1.00896059 -2.2678225  0.8750558  0.7518621  0.2302563  0.09717977 -0.4137670 -1.4250022 -0.62672549  1.2297374  0.2480763  0.6272348 -0.6159780  1.07271468 -0.6353077  0.1061901  1.03702081
          [,18]       [,19]       [,20]       [,21]       [,22]      [,23]       [,24]       [,25]       [,26]      [,27]       [,28]      [,29]      [,30]       [,31]       [,32]      [,33]      [,34]
[1,]  0.0624536  1.85081775  0.07073042 -0.21624155  0.64661457 -0.1342609 -0.13780008 -0.19504105  1.30893793  1.9290334 -1.77274216  1.1907728 -1.4025383  0.13096920  0.72719807 -0.1178643  0.1845331
[2,]  1.3787041 -1.90539897 -1.28527186 -0.74818360 -0.42596262  0.3466892  0.02295273  0.03817502 -0.46823665  0.9309509 -0.63572744 -1.3095404 -0.7762852 -0.67650843  0.05159689 -1.5187632  0.9564427
[3,] -0.1534182 -0.04210419 -0.09531591 -1.34001588  2.62938451 -1.7637229 -0.11048163  0.40062141 -0.07598591  0.1428821  0.01025366  0.1685266 -0.8592395 -0.20490048 -0.46749899 -0.6097403 -0.1536886
[4,]  0.1434296  0.64063048 -1.56232719  1.14351407  0.29634470  0.4405099  0.41390344 -0.69887372 -0.35606001  1.0280720  0.04683135  1.7643322  0.2450136 -1.12857562  0.50876362  1.8345622  0.7110533
[5,]  1.8982742  1.37770403  1.26038230 -0.04777317  0.56900604 -0.7967719 -0.53219421 -0.49768222  0.62879302 -0.8476621 -2.15019295 -1.2221986  1.6814433 -0.01945169  1.36987977 -1.0578891  0.3787905
[6,] -1.7788321 -2.05220517 -0.08428452 -0.16536344 -0.06452159 -0.7535617  0.87184939 -1.01194962  0.62101982 -0.9361646 -0.85592214  1.3564832 -0.8431024 -0.50798358  0.26188663 -1.2143237 -0.3163752
          [,35]       [,36]      [,37]      [,38]      [,39]      [,40]       [,41]       [,42]       [,43]       [,44]      [,45]       [,46]       [,47]      [,48]       [,49]       [,50]      [,51]
[1,]  1.0229744 -0.05576314  0.9990148  1.0444514  0.4417659  0.3100513  0.08769118 -0.08966491 -0.08560084 -1.26549917  0.8846524  0.19485787 -0.84968453 -0.5833535 -0.18451536 -2.22312378  0.8911218
[2,]  0.1419242  0.26892162  0.1496892  1.0260692 -0.1596688 -0.8625752 -0.03721688 -0.22357971 -0.65220568 -0.01419307 -0.4037000 -1.12132131 -0.34586749 -1.3423272 -1.65157994 -0.26908318 -0.7239282
[3,] -1.3379188  0.16884491 -0.2247204  0.6236395 -0.9070476  0.2199732  0.44359568  0.42075367  0.20166086 -1.04437358  1.4635003 -1.29855591  0.06858585  1.6375385 -0.64761629 -0.09089826  0.2805481
[4,]  0.1174268 -0.23292736  0.4939594  0.1292921  2.4128666 -0.1666592  0.12643804 -0.06265344  0.35422442 -1.08382300 -1.2241415  0.02152967 -0.15625663 -0.6698480  0.04924137 -1.00079690  0.3364263
[5,] -1.2953325 -0.43826922 -0.2918847  0.4908881 -0.3512625  1.8229432  0.29315375  1.08672467 -0.18412794 -0.05274977 -0.1293634  0.78297037  0.02869614  0.8889024  0.21002949 -1.37340296  1.3138245
[6,] -0.6197270  0.60299379  0.5443464 -0.3086574  1.5428251  0.6635639 -0.56375221  0.30536014  0.89334071 -0.22211421 -0.7710742 -0.33764262 -2.19075955 -0.1433221 -0.18774554 -0.55212706  0.7299787
          [,52]       [,53]      [,54]       [,55]      [,56]      [,57]      [,58]      [,59]       [,60]      [,61]      [,62]      [,63]     [,64]      [,65]        [,66]      [,67]       [,68]
[1,]  0.8696114  0.56232140  0.1951662  0.05148603  0.4273571  0.4352661  0.3822350  0.3980033 -0.45259119 -1.1960113 -0.3086574 -0.6231175 0.7360312 -1.1595428 -0.514234659  0.6106472 -0.23448839
[2,]  1.0787447 -0.50745717  1.2732951  0.06222543  0.9520249  0.3046317 -0.4838549 -0.5065676  2.09464345  0.3632793 -0.6285087  1.5344575 0.1397330  0.9941654 -0.002754351  0.2790219  0.22661178
[3,] -1.1028231  0.11580234 -0.1428848 -0.26052726  1.7750854 -0.9771774  1.4277907 -0.1200595 -0.04252635  1.6274948 -0.3512813  0.7964125 0.5091595  1.2336521 -1.315062229 -0.4497283  0.41782359
[4,] -1.2522941  0.03817502 -1.1374296  0.29315375 -1.2998773 -0.5187943  1.9518499  0.5740757  0.14011353  0.9716975  0.2844409 -1.5390124 0.7342756 -1.5500941 -0.321597945  1.4869384  0.40200674
[5,] -0.7530998 -0.06451134 -0.3133220 -0.41641866  0.8775938 -1.8914034 -1.5899290 -0.3096452  0.65620628  0.2170018 -0.1041245 -0.3465539 0.5443795 -1.1660196  0.823052245 -0.1368583  1.11171296
[6,] -2.1616834  0.34652589 -1.0966784 -1.18998468 -1.8261256  1.0668072 -0.4150144  0.3465167 -0.51142830 -0.2432252  0.3683840  2.4476635 3.1912317  0.5095651 -0.835171688  0.4454921  0.02024074
          [,69]       [,70]       [,71]       [,72]      [,73]      [,74]      [,75]      [,76]      [,77]       [,78]       [,79]      [,80]      [,81]      [,82]      [,83]      [,84]      [,85]
[1,] -1.7478507 -0.08227931  0.07073042 -0.24038435 -1.5263481 -1.0180366 -2.2220494  0.3532144  1.3452585  1.60945286 -2.31681859  1.3816250 -1.3752720  0.7263312 -0.2970750 -1.0127150  0.8922912
[2,]  1.6617126  0.58022953  1.40572970 -0.86069058 -0.2910185 -0.9169325  0.3095311  0.7728221  1.7176308 -0.94277335 -0.03651249  0.1075146 -1.3446352  0.2964361  0.2634083 -0.8320903 -0.5105455
[3,] -1.6055459 -2.05132691  3.59686291 -0.08537309  0.3568885 -1.7127041  1.6781156 -1.7631516 -1.1769177  0.01573268  0.48928879 -1.8244066 -0.7914249 -1.1578195  1.1395716  0.8581209  0.6470403
[4,] -1.2207835  0.49305614 -0.29083305 -0.78113079  0.4993147 -2.7094816 -1.6513265 -1.5433248  0.2466762 -0.46823665 -1.42032747 -1.4237257 -1.0578891  0.9756903  1.9106976 -0.4825009  0.2139788
[5,] -0.8541833  0.77554038 -1.92987787  0.61667924 -0.1857114 -1.1609349 -1.2688204  1.4467903  1.0143263  0.66650593 -0.12871937  1.7320070  0.1878734 -0.4575387  0.3245492 -0.1607804 -1.6720256
[6,] -0.3890587 -0.02042401  0.36977659 -0.30262975 -0.1650905 -1.1292788  1.6970970 -2.3499549 -0.6225399  0.41364426 -0.60965228 -0.8756184  0.2100295  0.2944163  0.5773681  0.1635233  0.7335472
            [,86]      [,87]      [,88]      [,89]       [,90]      [,91]      [,92]       [,93]      [,94]       [,95]      [,96]       [,97]      [,98]      [,99]     [,100]
[1,] -0.064607119 -0.2367104 -0.2070925  1.3138252 -0.37584113  0.3357212 -0.5074572 -0.83455855 -1.5344640 -0.15410186 -1.3262749  0.29999401  0.5330659 -0.1254342 -0.9691341
[2,]  0.007754136  0.4533051  0.2532113  0.2811322  0.09113366 -0.5698357  1.0588169 -0.52549455 -0.6037968  0.05055025 -0.3361038 -0.12310399 -0.6966858 -0.1664469  0.2414301
[3,]  0.667510266 -1.0842314 -2.4580069 -1.5494227 -0.89468997  0.1137547 -1.6877042  0.80605108 -0.2587580  1.25436359 -0.8852208  0.01312511  0.9982680 -0.5161622  0.9859031
[4,]  2.801611120 -1.0952208 -0.4580660 -0.9965764 -2.00546985  1.2919697 -0.1342609  0.07900341 -0.1166726 -0.73123679 -0.1659483 -0.59265158  2.3828029 -0.0883678  1.6882802
[5,]  1.288085761 -1.9600721  0.5960797  0.6176978 -1.42835307 -0.8043833 -0.7287700  1.41158167  0.5638301 -0.74222141 -2.3534239  0.34229115  0.7562357 -0.7000356  0.2513266
[6,] -0.203152174 -0.6762833 -0.4684628 -0.3260582 -1.48654972  0.2942190 -1.3446802 -0.12178229 -0.5551344  2.08301252  2.2497549 -0.43865917 -1.0055429  0.4449831  0.1601159
## 100개의  sample 로부터 각각의 표본평균 계산
R > apply(z.100,2,mean)
  [1]  0.092981795 -0.205347231 -0.098968555 -0.106428040 -0.108699247 -0.043078220  0.040623621 -0.155324081 -0.061241605 -0.072508308  0.098931389 -0.044948093  0.016035435  0.171100226 -0.066355323
 [16]  0.075226183 -0.001135491  0.088669178  0.051112704 -0.116037515 -0.151990407 -0.355581809 -0.023714443  0.046700038 -0.026596875  0.105601133 -0.062067246 -0.233237989 -0.158180715 -0.072835769
 [31]  0.032064930 -0.064217417 -0.140998739  0.041340305 -0.046350600 -0.027448872 -0.024105306 -0.057683370 -0.041138892 -0.133152085  0.074826247 -0.088414789 -0.180014547  0.026073179  0.027848912
 [46] -0.154589476  0.106905994 -0.017199041  0.049874579 -0.053925136  0.071379916 -0.149317291 -0.118381227 -0.028458915 -0.022162812  0.226027603 -0.092200778 -0.148227802 -0.107363442  0.059760477
 [61]  0.062293553  0.029769778  0.038492551  0.077033320  0.016963549 -0.051291049 -0.206467003  0.007110420 -0.073843819 -0.084431377  0.142583534 -0.125892490  0.054228473 -0.176994637 -0.031222164
 [76]  0.043189102  0.082395599 -0.172516329 -0.026293618 -0.191572310  0.004304568  0.032422049 -0.070168862  0.006275166  0.083256790 -0.031242603 -0.006008473  0.058112073 -0.149998031 -0.121366853
 [91]  0.004672088 -0.059235401  0.139431373 -0.023659478 -0.124593329 -0.058071167  0.050447236 -0.072075474  0.004957442 -0.197229033
## 100개의 sample 로부터 각각의 표본표준편차 계산
R > apply(z.100,2,sd)
  [1] 1.0757487 0.9394098 1.0334794 1.1892744 1.0771073 1.0020863 1.0118017 0.8996410 0.9264403 0.9434038 0.9698961 1.2481382 1.0185435 0.8536223 1.0412810 0.9462391 1.1351210 1.0063888 1.0824624 0.9715800
 [21] 0.9838955 1.0167810 1.0280130 0.9969053 1.0205194 1.1449220 1.0057652 1.0277182 1.0358680 1.0252696 0.8425971 0.9585354 1.0274961 1.0038874 1.0012593 0.8797492 1.0489517 1.0337238 1.0539399 0.9885656
 [41] 0.9207233 0.8218975 0.9092544 0.9310459 1.1247936 0.9180475 1.0692252 1.0107441 0.9848324 0.9959008 0.9301011 0.9287554 1.0225028 1.0148335 1.0715833 0.9745005 0.9987549 1.0089638 1.0394985 0.9686517
 [61] 0.9158696 1.0484538 1.1249065 0.9991403 0.9830248 1.0939655 1.1481726 0.9926324 1.0500059 0.9525750 1.0761901 0.9288811 1.0265274 1.1182464 1.1163071 1.0083782 1.0254404 0.9570283 1.0253828 1.0622927
 [81] 1.0506743 1.1296204 1.0183193 1.0527589 0.9444769 1.0741502 1.1085824 1.0346829 1.0507469 0.9803243 1.0088471 1.0109398 0.9816600 0.9267594 1.0812624 1.0119884 0.9397777 0.8833393 1.0384513 0.9456778
## 100개 표본평균의 히스토그램 작성
R > hist(apply(z.100,2,mean))
## 100개 표본평균의 표준편차 계산 => 표본표준편차, 즉 표준오차임에 유의. 
## sqrt(100)으로 모 표준편차 1을 나누어 준 값과 비슷해야 함.
R > sd(apply(z.100,2,mean))
[1] 0.09897198
## 이론값과 비교
R > 1/sqrt(100)
[1] 0.1
## N(0,1) 로부터 추출한 10,000개 표본의 히스토그램, 표준정규곡선과 닮은 것 확인 
R > hist(z,prob=T)
## t-test 통계량의 분포를 찾아낸  Gosset 의 방법 복기. 사이즈 4인 표본을 2,500개 구성
R > z.4<-replicate(2500,sample(z,size=4,replace=F))
## 4 by 2,500 행렬 탄생
R > str(z.4)
 num [1:4, 1:2500] 0.367 0.533 1.36 -0.526 -1.062 ...
## 사이즈 4인 표본의 표본평균 계산. 2,500 개의 표본평균 탄생
R > x.bar.4<-apply(z.4,2,mean)
## 각 표본의 표준편차 계산, 2,500개의 표준편차 탄생
R > sd.bar.4<-apply(z.4,2,sd)
## z-통계량 계산. 모평균=0, 모표준편차=1 임을 활용
R > z.stat.4<-x.bar.4*sqrt(3)
## z-통계량의 히스토그램 작성. 표준편차가 0.1에 가까운 점에 유의 
R > hist(z.stat.4,xlim=c(-4,4), prob=T)
## t-통계량 계산. 귀무가설 하에 모평균 = 0이고 표본의 표준편차로 나눠 줌에 유의
R > t.stat.4<-x.bar.4*sqrt(3)/sd.bar.4
##  density estimation으로 두 통계량의 표본분포 비교. t- 통계량이 옆으로 좀더 퍼져 있음에 유의.
R > plot(density(z.stat.4),xlim=c(-4,4),main="z vs t(df=3)")
R > lines(density(t.stat.4),col="red")
## QQplot으로 비교. t-통계량의 그것이 꼬리가 두터움을 의미함.
R > qqnorm(z.stat.4)
R > qqnorm(t.stat.4)
## 각종 그림 png 파일로 저장
R > png("normal_vs_t.png",width=640,height=640)
R > plot(density(z.stat.4),xlim=c(-4,4),main="z vd t(df=3)")
R > lines(density(t.stat.4),col="red")
R > dev.off()
## QQplot()
R > png("normal_vs_t_qqplot.png",width=640,height=640)
R > qqplot(z.stat.4,t.stat.4,main="normal vs t")
R > dev.off()
## QQnorm() 을 z-통계량과 비교
R > png("qqnorm_normal.png",width=640,height=640)
R > qqnorm(z.stat.4,main="normal")
R > dev.off()
## QQnorm() 을 t-통계량과 비교
R > png("qqnorm_t.png",width=640,height=640)
R > qqnorm(t.stat.4,main="t")
R > dev.off()
quartz 
     2 

